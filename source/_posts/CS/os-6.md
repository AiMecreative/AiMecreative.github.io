---
title: 【操作系统】Interruption
date: 2023-06-28 16:08:23
tags:
  - CS
  - OS
  - NJU
categories: CS
author: Andrew-Rey
mathjax: true
---

"中断机制是现代操作系统的基石"

<!--more-->

## 中断

> 多处理器的状态机：每个CPU有单独的寄存器，共享同一块内存，每次执行需要选择CPU来执行
>
> - 如果某个CPU陷入死循环，则死机

> 中断：gdb调试可以看见有`eflags`寄存器存储中断的信号（IF）
>
> - 跳转
> - x86：获得中断号n（由中断）

> 关闭中断：`cli`(clear interrupt flag)
>
> - 直接在应用程序中关闭时：`SIGSEGV`段错误（address boundary error）

> 单处理器上并发来自于中断
>
> - 实现单处理器多线程避免数据竞争：关闭中断，等待数据操作结束，打开中断

> 中断保存和恢复寄存器

> 单处理器上下文切换
>
> - 发生中断-操作系统代码开始执行-状态机被封存-切换到另一个状态机-中断返回另一个状态机的状态-此时封存的状态还在-可以被恢复到处理器上执行

> 线程切换
>
> - 程序的状态：包括了代码段、数据段，这二者对所有的线程共享；除此之外，状态内有一定数量的线程，每个线程有自己的状态，包括自己的堆栈，自己的数据信息（例如名字）；此外还有一系列寄存器
> - 状态的转移：获取一条指令/发生中断
> - 中断发生：把处理器的寄存器保存在内存，再从内存中还回处理器